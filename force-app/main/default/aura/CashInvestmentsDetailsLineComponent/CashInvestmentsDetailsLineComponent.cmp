<aura:component>
  <aura:attribute
    name="containerName"
    type="String"
    default="CashInvestmentsDetailLineComponent"
  />
  <aura:registerEvent name="productDetailsEvent" type="c:ProductDetailsEvent" />
  <aura:attribute
    name="ChildContainer"
    type="Map"
    default="{}"
    description="CashInvestment container"
  />
  <aura:attribute
    name="ParentContainer"
    type="Map"
    default="{}"
    description="Credit Card Other Detail Line Component container"
  />
  <aura:attribute
    name="financialInstitution"
    type="List"
    default="['JN Bank Ltd.','JN Fund Managers Ltd.']"
  />
  <aura:attribute name="accountType" type="List" default="[]" />
  <aura:attribute
    name="notifyContainerChange"
    type="Boolean"
    default="true"
    description="used to indicate whether the component should react to the ChildContainer changes"
  />
  <aura:attribute
    name="accountTypeWhenJNBankIsSelected"
    type="List"
    default="['Savings account types', 'Fixed Deposit account Types']"
  />

  <aura:attribute
    name="accountTypeWhenJNFundManagerIsSelected"
    type="List"
    default="['Repo', 'Mutual Fund']"
  />

  <aura:attribute name="isHypothecated" type="List" default="['Yes','No']" />

  <!-- Toggle Flags -->
  <aura:attribute name="accountTypeDisableFlag" type="Boolean" default="true" />
  <aura:attribute name="bankSelectedFlag" type="Boolean" default="false" />
  <aura:attribute
    name="fundManagerSelectedFlag"
    type="Boolean"
    default="false"
  />
  <aura:attribute name="hypothecatedLoanFlag" type="Boolean" default="false" />
  <aura:attribute name="scriptsLoaded" type="Boolean" default="false" />
  <ltng:require
    scripts="{!join(',', 
  $Resource.constants,
  $Resource.calculations, 
  $Resource.productDetailsGeneralFunctions)}"
    afterScriptsLoaded="{!c.scriptsLoaded}"
  />
  <!--JN1-4021-->
  <aura:method
    name="validateFields"
    action="{!c.validateFields}"
    access="public"
  />
  <!-- Handlers -->
  <aura:handler name="init" value="{!this}" action="{!c.doInit}" />
  <aura:handler
    name="change"
    action="{!c.onChildContainerChange}"
    value="{!v.ChildContainer}"
  />

  <!--<aura:attribute name="depositCurrency" type="List" default="['JMD','USD']" />
  <aura:attribute name="depositAccNumber" type="Integer" />
  <aura:attribute name="accountHolder" type="String" />
  <aura:attribute name="annualInterestRate" type="Decimal" />
  <aura:attribute name="depositBalance" type="Decimal" /> -->

  <lightning:layout multipleRows="true">
    <lightning:layoutItem size="12">
      <h2 class="slds-section-title--divider">Cash/Investment Details</h2>
    </lightning:layoutItem>
    <lightning:layoutItem size="12" mediumDeviceSize="4" padding="around-small">
      <div class="slds-form-element">
        <div class="slds-form-element__control">
          <lightning:select
            aura:id="cashInvestmentsSelectComponent"
            name="select1"
            label="Financial Institution"
            required="true"
            onchange="{!c.onFinancialInstitutionChange}"
          >
            <option value="">select one...</option>
            <aura:iteration items="{!v.financialInstitution}" var="item">
              <option value="{!item}">{!item}</option>
            </aura:iteration>
          </lightning:select>
        </div>
      </div>
    </lightning:layoutItem>
    <lightning:layoutItem size="12" mediumDeviceSize="4" padding="around-small">
      <div class="slds-form-element">
        <div class="slds-form-element__control">
          <lightning:select
            aura:id="cashInvestmentsSelectComponent"
            name="select1"
            label="Account Type"
            required="true"
            onchange="{!c.onAccountTypeChange}"
            disabled="{!v.accountTypeDisableFlag}"
          >
            <option value="">select one...</option>
            <aura:iteration items="{!v.accountType}" var="item">
              <option value="{!item}">{!item}</option>
            </aura:iteration>
          </lightning:select>
        </div>
      </div>
    </lightning:layoutItem>
    <aura:if isTrue="{!v.fundManagerSelectedFlag}">
      <lightning:layoutItem
        size="12"
        mediumDeviceSize="4"
        padding="around-small"
      >
        <div class="slds-form-element">
          <div class="slds-form-element__control">
            <lightning:input
              aura:id="cashInvestmentsTextComponent"
              type="text"
              label="Deposit Account Number"
              value="{!v.ChildContainer.depositAccountNumber}"
              name="Indicate Applicable Processing Fees(%)"
              required="true"
            />
          </div>
        </div>
      </lightning:layoutItem>
    </aura:if>
    <aura:if isTrue="{!v.bankSelectedFlag}">
      <lightning:layoutItem
        size="12"
        mediumDeviceSize="12"
        padding="around-small"
      >
        <lightning:layout>
          <lightning:layoutItem
            size="12"
            mediumDeviceSize="6"
            padding="around-small"
          >
            <div class="slds-form-element">
              <div class="slds-form-element__control">
                <lightning:input
                  aura:id="cashInvestmentsTextComponent"
                  type="text"
                  label="Deposit Account Number Prefix"
                  value="{!v.ChildContainer.jnBankAccountNumberPrefix}"
                  pattern="^([^0-9]*)$"
                  maxlength="3"
                  required="true"
                />
              </div>
            </div>
          </lightning:layoutItem>
          <lightning:layoutItem
            size="12"
            mediumDeviceSize="6"
            padding="around-small"
          >
            <div class="slds-form-element">
              <div class="slds-form-element__control">
                <lightning:input
                  aura:id="cashInvestmentsTextComponent"
                  type="text"
                  label="Deposit Account Number"
                  value="{!v.ChildContainer.jnBankAccountNumber}"
                  required="true"
                />
              </div>
            </div>
          </lightning:layoutItem>
        </lightning:layout>
      </lightning:layoutItem>
    </aura:if>
    <lightning:layoutItem size="12" mediumDeviceSize="6" padding="around-small">
      <div class="slds-form-element">
        <div class="slds-form-element__control">
          <lightning:input
            aura:id="cashInvestmentsTextComponent"
            type="text"
            label="Account Holder(s)"
            value="{!v.ChildContainer.accountHolder}"
            name="Account Holders"
            required="true"
          />
        </div>
      </div>
    </lightning:layoutItem>
    <lightning:layoutItem size="12" mediumDeviceSize="6" padding="around-small">
      <div class="slds-form-element">
        <div class="slds-form-element__control">
          <lightning:input
            aura:id="cashInvestmentsNumericalComponent"
            type="number"
            label="Annual Interest Rate on Deposit Account"
            value="{!v.ChildContainer.annualInterestRate}"
            name="Annual Interest Rate"
            formatter="percent-fixed"
            step="0.01"
            required="true"
          />
        </div>
      </div>
    </lightning:layoutItem>
    <lightning:layoutItem size="12" mediumDeviceSize="6" padding="around-small">
      <div class="slds-form-element">
        <div class="slds-form-element__control">
          <lightning:select
            aura:id="cashInvestmentsSelectComponent"
            name="select1"
            label="Is this account hypothecated for another loan?"
            required="true"
            onchange="{!c.onIsHypothecatedChange}"
          >
            <option value="">select one...</option>
            <aura:iteration items="{!v.isHypothecated}" var="item">
              <option value="{!item}">{!item}</option>
            </aura:iteration>
          </lightning:select>
        </div>
      </div>
    </lightning:layoutItem>
    <aura:if isTrue="{!v.hypothecatedLoanFlag}">
      <lightning:layoutItem
        size="12"
        mediumDeviceSize="6"
        padding="around-small"
      >
        <lightning:input
          aura:id="cashInvestmentsNumericalComponent"
          type="number"
          label="Enter the Existing Loan Balance"
          value="{!v.ChildContainer.existingBalance}"
          name="number"
          formatter="currency"
          required="true"
        />
      </lightning:layoutItem>
    </aura:if>
    <lightning:layoutItem size="12" mediumDeviceSize="6" padding="around-small">
      <lightning:layout>
        <!-- <lightning:layoutItem size="3" mediumDeviceSize="3">
          <lightning:select
            name="select1"
            label="$"
            required="true"
            onchange="{!c.onDepositCurrencyChange}"
          >
            <aura:iteration items="{!v.depositCurrency}" var="item">
              <option value="{!item}">{!item}</option>
            </aura:iteration>
          </lightning:select>
        </lightning:layoutItem> -->
        <lightning:layoutItem size="12">
          <lightning:input
            aura:id="cashInvestmentsNumericalComponent"
            type="number"
            label="Deposit Account Balance"
            value="{!v.ChildContainer.depositBalance}"
            name="deposit"
            formatter="currency"
            required="true"
            onchange="{!c.validateBalance}"
          />
        </lightning:layoutItem>
      </lightning:layout>
    </lightning:layoutItem>
  </lightning:layout>
</aura:component>
